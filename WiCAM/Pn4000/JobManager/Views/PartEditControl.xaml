<UserControl x:Class="WiCAM.Pn4000.JobManager.PartEditControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                xmlns:smtx="clr-namespace:ShowMeTheXAML;assembly=ShowMeTheXAML"
               xmlns:mdix="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"
             xmlns:system="clr-namespace:System;assembly=mscorlib"
             xmlns:mahMaterialDragablzMashUp="clr-namespace:WiCAM.Pn4000.JobManager"
   xmlns:wf="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms"  
             xmlns:local="clr-namespace:WiCAM.Pn4000.JobManager"
             xmlns:helpers="clr-namespace:WiCAM.Pn4000.JobManager.Helpers"
              xmlns:Metro="http://metro.mahapps.com/winfx/xaml/controls"
                     xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation" 
                xmlns:controls4="clr-namespace:WiCAM.Pn4000.pn4.pn4UILib"
                xmlns:anycad="clr-namespace:AnyCAD.WPF;assembly=AnyCAD.WPF.NET8" 
                     xmlns:controls3="clr-namespace:WiCAM.Pn4000.WpfBasics.Controls;assembly=WiCAM.Pn4000.WpfBasics" 

             xmlns:controls1="clr-namespace:WiCAM.Pn4000.ScreenD3D.Controls;assembly=WiCAM.Pn4000.ScreenD3D"
             xmlns:controls11="clr-namespace:WiCAM.Pn4000.ScreenD3D.Renderer;assembly=WiCAM.Pn4000.ScreenD3D" 
             xmlns:interop="clr-namespace:System.Windows.Interop;assembly=PresentationCore" xmlns:docking="clr-namespace:WiCAM.Pn4000.GuiWpf.GeneralUI.Docking;assembly=WiCAM.Pn4000.GuiWpf">
    <UserControl.Resources>
        <local:BorderHeightConverter x:Key="converterImageHeight"/>
        <DataTemplate x:Key="AlbumStyle">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="260" />
                    <ColumnDefinition Width="60" />
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="{Binding Path=Title}" />
                <TextBlock Grid.Column="1" Text="{Binding Path=Tracks#.Count}" HorizontalAlignment="Right" />
            </Grid>
        </DataTemplate>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" MinHeight="200"/>
            <RowDefinition Height="40" />
        </Grid.RowDefinitions>
        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition MaxWidth="460"/>
                <ColumnDefinition Width="8"/>
                <ColumnDefinition Width="{Binding Column1Width, Mode=TwoWay}" />
            </Grid.ColumnDefinitions>
            <TabControl Grid.Column="0"  Metro:HeaderedControlHelper.HeaderFontSize="16" Metro:TabControlHelper.UnderlineBrush="#FFF75656" Metro:TabControlHelper.Underlined="SelectedTabItem">
                <TabItem Header="Root" MouseRightButtonDown="TabItem_MouseRightButtonDown" MouseLeftButtonDown="TabItemRoot_MouseLeftButtonDown">
                    <TreeView SelectedItemChanged="Browser_SelectedItemChanged"
             ItemsSource="{Binding RootDirectoryItems}">
                        <TreeView.Resources>
                            <HierarchicalDataTemplate DataType="{x:Type local:UserDirectory}" ItemsSource="{Binding Items}">
                                <Label Content="{Binding Name}" />
                            </HierarchicalDataTemplate>
                            <DataTemplate DataType="{x:Type local:UserFile}">
                                <Label Content="{Binding Name}" />
                            </DataTemplate>
                        </TreeView.Resources>
                    </TreeView>
                </TabItem>
                <TabItem Header="PartEdit">

                    <TextBox x:Name="editor" x:FieldModifier="public"
                             Margin="5,5,5,5" BorderThickness="5,5,5,5" 
                             controls:ScrollViewerHelper.IsHorizontalScrollWheelEnabled="True" 
                             controls:ControlsHelper.MouseOverBorderBrush="#FF933232" SelectionTextBrush="#FF1E1212" 
                             controls:ControlsHelper.FocusBorderBrush="#FF4D8082" Background="#FF3E3C3C" 
                             VerticalScrollBarVisibility="Visible" AcceptsTab="True" controls:ControlsHelper.FocusBorderThickness="10,10,10,10" FontSize="10" />

                </TabItem>
                <TabItem Header="StepTree">
                    <TreeView x:Name="treeView" Margin="5" MinWidth="300" 
            VerticalAlignment="Stretch" Width="Auto" HorizontalContentAlignment="Stretch" 
            ScrollViewer.VerticalScrollBarVisibility="Auto" 
            VerticalContentAlignment="Stretch"  SelectedItemChanged="treeView_SelectedItemChanged" 
             BorderThickness="3,3,3,3" Background="OldLace" FontSize="14" >
                        <FrameworkElement.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="OpenFolder" Click="Image_OpenFolderMouseLeftButtonDown">
                                    <MenuItem.Icon>
                                        <Image Source="{StaticResource BitmapJobProduce32}" />
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem Header="Todo" >
                                    <MenuItem.Icon>
                                        <Image Source="{StaticResource BitmapJobDelete32}" />
                                    </MenuItem.Icon>
                                </MenuItem>
                            </ContextMenu>
                        </FrameworkElement.ContextMenu>
                        <TreeView.ItemContainerStyle>
                            <Style TargetType="{x:Type TreeViewItem}">
                                <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}" />
                                <Setter Property="KeyboardNavigation.AcceptsReturn" Value="True" />
                            </Style>
                        </TreeView.ItemContainerStyle>
                        <TreeView.Resources>
                            <HierarchicalDataTemplate DataType="{x:Type local:UserStepFileTree}" ItemsSource="{Binding Path=Files}" >
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Path=Name}"></TextBlock>
                                </StackPanel>
                            </HierarchicalDataTemplate>
                            <DataTemplate DataType="{x:Type local:UserStepFile}"  >
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Path=Name}"></TextBlock>
                                </StackPanel>
                            </DataTemplate>
                        </TreeView.Resources>
                    </TreeView>
                </TabItem>
                <TabItem Header="Test" MouseRightButtonDown="TabItemTest_MouseLeftButtonDown">

                </TabItem>
            </TabControl>

            <StackPanel  Grid.Column="0" >
                <Button Command="{Binding OpenModelCommand}" Content="AnyCadView" Click="Button_Click"></Button>
                <TreeView ItemTemplate="{StaticResource AlbumStyle}"
ItemsSource="{Binding }" />


            </StackPanel >

            <Popup PlacementTarget="{Binding ElementName=mRenderCtrl}" 
         Placement="Relative" StaysOpen="True" IsOpen="True" AllowsTransparency="True">
                <Label Content="{Binding SelectionInfo}" ></Label>
            </Popup>

            <GridSplitter Grid.Column="1" VerticalAlignment="Stretch" 
                Width="8" ResizeDirection="Columns" Background="Gray" Margin="0,0,0,0" />
            <DockPanel  Grid.Column="2" x:Name="AnyCad3Dscreen" Visibility="Hidden"  >
                <anycad:RenderControl  x:Name="mRenderCtrl" Margin="0,0,0,0" ViewerReady="RenderCtrl_ViewerReady"  />

            </DockPanel>
            <Grid Name="MainScreenGrid" Row="4">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <docking:DockingContainer x:Name="Docking" Grid.Column="1">
                    <docking:DockingContainer.ChildContent>
                        <Grid Name="gridm" Background="{DynamicResource Pn4Toolbars.ToolbarTrayBackgroundColorBrush}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="30" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <Grid Row="0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" MaxHeight="22" />
                                </Grid.RowDefinitions>
                                <Grid Name="topInfoGrid" Row="0" Height="28">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <ToolBar Name="QAT_tl" Grid.Column="0" Background="#00FFFFFF" ToolBarTray.IsLocked="True" 
                                             Visibility="Hidden" Loaded="ToolBar_Loaded" />
                                    <Grid Column="1">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Name="StatusBarSlot0" Width="50*" MinWidth="30" />
                                            <ColumnDefinition Name="StatusBarSlot1" Width="50*" MinWidth="30" />
                                        </Grid.ColumnDefinitions>
                                        <ContentControl Grid.Column="0" Content="{Binding PnStatusBar.Slot[0]}" />
                                        <GridSplitter Grid.Column="0" Style="{DynamicResource LocalPnStatusBarGridSplitterStyle}" />
                                        <ContentControl Grid.Column="1" Content="{Binding PnStatusBar.Slot[1]}" />
                                    </Grid>
                                    <ToolBar Name="QAT_tr" Grid.Column="2" Background="#00FFFFFF" ToolBarTray.IsLocked="True" 
                                             Visibility="Hidden" Loaded="ToolBar_Loaded" />
                                </Grid>
                                <controls2:RadTabbedWindow Grid.Row="1" xmlns:controls2="clr-namespace:Telerik.Windows.Controls;assembly=Telerik.Windows.Controls.Navigation" controls2:RadTabbedWindow.DisplayMemberPath="Header" controls2:WindowBase.HideMinimizeButton="True" controls2:WindowBase.HideMaximizeButton="True" controls2:RadTabbedWindow.DragDropMode="Reorder" controls2:WindowBase.CanClose="False" controls2:RadTabbedWindow.AddButtonVisibility="Collapsed" controls2:RadTabbedWindow.ItemsSource="{Binding DocumentManager.Documents}" controls2:RadTabbedWindow.SelectedItem="{Binding DocumentManager.SelectedDoc}" UIElement.Visibility="{Binding DocumentManager.Visibility}">
                                    <controls2:RadTabbedWindow.ItemContainerStyle>
                                        <Style TargetType="{x:Type controls2:RadTabItem}">
                                            <Setter Property="controls2:RadTabItem.PinButtonVisibility" Value="Visible" />
                                            <Setter Property="controls2:RadTabItem.CloseButtonVisibility" Value="Visible" />
                                            <Setter Property="Control.BorderThickness" Value="4" />
                                            <Setter Property="Control.BorderBrush" Value="{Binding BorderSelected}" />
                                            <Setter Property="Control.Background" Value="#FFF5F5F5" />
                                        </Style>
                                    </controls2:RadTabbedWindow.ItemContainerStyle>
                                    <!--     <controls2:RadWindow.Icon>
                                      <controls3:WiButton controls3:WiButton.Key="TabbedWindow.TileView" UIElement.IsEnabled="False"
                                                            FrameworkElement.Margin="0,-5" ButtonBase.Command="{Binding DocumentManager.CmdTileView}">
                                            <telerik:RadGlyph Glyph="" Margin="0,5" />
                                        </controls3:WiButton>
                                    </controls2:RadWindow.Icon>-->
                                    <controls2:RadTabbedWindow.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Ellipse Width="10" Height="10" Fill="#FFFFA500" ToolTip="{DynamicResource DocumentManagement.DocBusy}" Visibility="{Binding BusyVisibility}">
                                                    <FrameworkElement.Triggers>
                                                        <EventTrigger RoutedEvent="Ellipse.Loaded">
                                                            <BeginStoryboard>
                                                                <Storyboard>
                                                                    <DoubleAnimation Storyboard.TargetProperty="Height" From="5.0" To="12.0" Duration="0:0:7" AutoReverse="True" RepeatBehavior="Forever" />
                                                                    <DoubleAnimation Storyboard.TargetProperty="Width" From="5.0" To="12.0" Duration="0:0:7" AutoReverse="True" RepeatBehavior="Forever" />
                                                                </Storyboard>
                                                            </BeginStoryboard>
                                                        </EventTrigger>
                                                    </FrameworkElement.Triggers>
                                                </Ellipse>
                                                <TextBlock FontWeight="Normal" Margin="5 0 0 0" Text="{Binding Header}" ToolTip="{Binding Tooltip}" />
                                            </StackPanel>
                                        </DataTemplate>
                                    </controls2:RadTabbedWindow.ItemTemplate>
                                </controls2:RadTabbedWindow>
                            </Grid>
                            <GridSplitter Name="PartPaneGridSplitter" Grid.Row="2" HorizontalAlignment="Stretch" Visibility="Hidden" />
                            <controls4:PartPaneControl x:Name="PartPanePanel" Grid.Row="1" Visibility="Collapsed" />
                            <Grid Name="gridmm" Row="4" Background="#00FFFFFF">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <GridSplitter Name="GridSplitterPropertyPanel" Background="#00FFFFFF" Grid.Column="1" 
                                              Width="4" Visibility="Collapsed" HorizontalAlignment="Stretch"
                                              MouseUp="GridSplitterPropertyPanel_MouseUp" 
                                              PreviewMouseUp="GridSplitterPropertyPanel_PreviewMouseUp" 
                                              PreviewMouseDown="GridSplitterPropertyPanel_PreviewMouseDown" />
                                <DockPanel Name="KernelScreenPanel" Background="#00FFFFFF" Visibility="Hidden" Grid.Column="2" HorizontalAlignment="Stretch" Margin="0,0,0,0" VerticalAlignment="Stretch" IsVisibleChanged="KernelScreenPanel_IsVisibleChanged" />
                                <controls1:Screen3D x:Name="Kernel3DScreen" Visibility="Hidden" Grid.Column="2" HorizontalAlignment="Stretch" Margin="0,0,0,0" VerticalAlignment="Stretch" />
                                <ContentControl Name="configControl" Visibility="Hidden" Margin="0" Grid.Column="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch" />
                                <Grid Name="ContentOverlay" Visibility="Visible" Margin="0" Column="2" />
                            </Grid>
                            <StackPanel Name="MultiTaskTabsPanel" Grid.Row="3" Orientation="Horizontal" />
                        </Grid>
                    </docking:DockingContainer.ChildContent>
                </docking:DockingContainer>
                <ToolBarTray Name="toolbartray_left" Grid.Column="0" Orientation="Vertical" />
                <ToolBarTray Name="toolbartray_right" Grid.Column="2" Orientation="Vertical" />
            </Grid>
            <ToolBarTray Name="toolbartray_bottom" Grid.Row="5" />
            <Grid Row="6" Height="28" Background="{DynamicResource Pn4Toolbars.ToolbarTrayBackgroundColorBrush}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <ToolBar Name="QAT_bl" Grid.Column="0" ToolBarTray.IsLocked="True" Visibility="Hidden" Background="#00FFFFFF" Loaded="ToolBar_Loaded" />
                <Grid Column="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Name="StatusBarSlot2" Width="16*" MinWidth="30" />
                        <ColumnDefinition Name="StatusBarSlot3" Width="16*" MinWidth="30" />
                        <ColumnDefinition Name="StatusBarSlot4" Width="16*" MinWidth="30" />
                        <ColumnDefinition Name="StatusBarSlot5" Width="16*" MinWidth="30" />
                        <ColumnDefinition Name="StatusBarSlot6" Width="16*" MinWidth="30" />
                        <ColumnDefinition Name="StatusBarSlot7" Width="16*" MinWidth="30" />
                    </Grid.ColumnDefinitions>
                    <ContentControl Grid.Column="0" Content="{Binding PnStatusBar.Slot[2]}" />
                    <GridSplitter Grid.Column="0" Style="{DynamicResource LocalPnStatusBarGridSplitterStyle}" />
                    <ContentControl Grid.Column="1" Content="{Binding PnStatusBar.Slot[3]}" />
                    <GridSplitter Grid.Column="1" Style="{DynamicResource LocalPnStatusBarGridSplitterStyle}" />
                    <ContentControl Grid.Column="2" Content="{Binding PnStatusBar.Slot[4]}" />
                    <GridSplitter Grid.Column="2" Style="{DynamicResource LocalPnStatusBarGridSplitterStyle}" />
                    <ContentControl Grid.Column="3" Content="{Binding PnStatusBar.Slot[5]}" />
                    <GridSplitter Grid.Column="3" Style="{DynamicResource LocalPnStatusBarGridSplitterStyle}" />
                    <ContentControl Grid.Column="4" Content="{Binding PnStatusBar.Slot[6]}" />
                    <GridSplitter Grid.Column="4" Style="{DynamicResource LocalPnStatusBarGridSplitterStyle}" />
                    <ContentControl Grid.Column="5" Content="{Binding PnStatusBar.Slot[7]}" />
                </Grid>
                <ToolBar Name="QAT_br" Grid.Column="2" ToolBarTray.IsLocked="True" Visibility="Hidden" Background="#00FFFFFF" Loaded="ToolBar_Loaded" />
            </Grid>
        </Grid>
        <StatusBar Grid.Row="1" >
            <StatusBarItem Width="200" Content="{Binding MousePosition}"/>
            <StatusBarItem HorizontalAlignment="Center">
                <StackPanel Orientation ="Horizontal">
                    <TextBlock Text="{Binding MousePosition}"/>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>
    </Grid>


</UserControl>